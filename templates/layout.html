<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>BOX Atelier</title>
    <link rel="icon" type="image/png" href="static/img/favicon-32x32.png" sizes="32x32"> 
    <link rel="apple-touch-icon" sizes="196x196" href="static/img/favicon-196x196.png">
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="manifest" href="__manifest.json"> 
   
      
    <!-- ========= JS Files =========  -->

     <!-- Bootstrap -->
     <script src="static/js/lib/bootstrap.bundle.min.js"></script>
     <!-- Ionicons -->
     <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
     <!-- Splide -->
     <script src="static/js/plugins/splide/splide.min.js"></script>
     <!-- Base Js File -->
     <script src="static/js/base.js"></script>
     <!-- Apex Charts -->
     <script src="static/js/plugins/apexcharts/apexcharts.min.js"></script>
     <!-- jquery -->
     <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
   
  
</head>


<body>
     
    <!-- App Header -->
    <div class="appHeader bg-primary text-light">

        <div class="left">
            <a href="#" class="headerButton" data-bs-toggle="modal" data-bs-target="#sidebarPanel">
                <ion-icon name="menu-outline"></ion-icon>
            </a>
        </div>
        
        <div class="pageTitle">
          <img src="static/img/favicon-32x32.png" style="color:white" type="image/png" sizes="32x32">   <strong> MyBOX  </strong>
        </div>

        <div class="right">           
          <a class="headerButton" data-bs-toggle="offcanvas" href="#cookiesbox">
            <ion-icon style="color:rgb(252, 249, 249) "name="information-circle"></ion-icon>
          </a>
          
      </div>
    </div>
    

    {% block body %}{% endblock %}

    <!-- App Bottom Menu -->
    <div class="appBottomMenu">
        <a href="/actionneurs" class="item">
            <div class="col">
              <ion-icon name="toggle-outline"></ion-icon>
                <strong>Actionneurs</strong>
            </div>
        </a>
              
        <a href="/capteurs" class="item">
            <div class="col">
                <ion-icon name="speedometer-outline">"></ion-icon>
                <strong>Capteurs</strong>
            </div>
        </a>
        
        <a href="/graph" class="item">
          <div class="col">
              <ion-icon name="bar-chart-outline"></ion-icon>
              <strong>Graphiques</strong>
          </div>
        </a>

        <a href="/parameters" class="item">
            <div class="col">
              <ion-icon name="construct-outline"></ion-icon>
                <strong>Paramètres</strong>
            </div>
        </a>
        
        <a href="/events" class="item">
          <div class="col">
            <ion-icon name="list-outline"></ion-icon>
              <strong>Evénements</strong>
          </div>
      </a>

      </a>
    </div>
    <!-- * App Bottom Menu -->

    <!-- App Sidebar -->
    <div class="modal fade panelbox panelbox-left" id="sidebarPanel" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body p-0">

                    <!-- profile box -->
                    <div class="profileBox pt-2 pb-2">
                        <div class="image-wrapper">
                            <img src="static/img/profile.png" alt="image" class="imaged  w36">
                        </div>
                        <div class="in">
                            <strong>  Bienvenue :  {{USERNAME}} </strong>
                            upsince : {{LASTREBOOT}} 
                        </div>
                        <a href="#" class="btn btn-link btn-icon sidebar-close" data-bs-dismiss="modal">
                            <ion-icon name="close-outline"></ion-icon>
                        </a>
                    </div>
                    <!-- * profile box -->
                   

                    <!-- menu -->
                    <div class="listview-title mt-1">Menu</div>
                    
                    <ul class="listview flush transparent no-line image-listview">
                                            
                        <li>
                          <a href="#confirm_reboot" class="item" data-bs-toggle="modal" data-bs-target="#confirm_reboot">
                              <div class="icon-box bg-primary">
                                <ion-icon name="refresh"></ion-icon>
                              </div>
                              <div class="in">
                                  Redémarrer (reboot)
                              </div>
                          </a>
                        </li>

                        <li>
                          <a href="#confirm_shutdown" class="item" data-bs-toggle="modal" data-bs-target="#confirm_shutdown">
                              <div class="icon-box bg-primary">
                                <ion-icon name="power"></ion-icon>
                              </div>
                              <div class="in">
                                  Eteindre (shutdown)
                              </div>
                          </a>
                        </li>

                        <!--- <div class="dropdown-divider"></div>  -->
                        


                    </ul>
                    <!-- * menu -->
                </div>
            </div>
        </div>
    </div>
    <!-- * App Sidebar -->
    
    <!-- Info Box -->
    <div id="cookiesbox" class="offcanvas offcanvas-bottom cookies-box" tabindex="-1" data-bs-scroll="true" data-bs-backdrop="false">
      
      <div class="offcanvas-header">
        <h3 class="modal-title">{{APPNAME}} {{APPVERSION}}</h3>
      </div>
      
      <div class="offcanvas-body">
        <p>
          BOX Atelier est un projet de boitier connecté et commandé via une APP web. 
          
          Equipé d'un Raspberry Pi 4 qui pilote trois relais 240V, d'une sonde d'humidité de l'air, de sondes 
          de températures de l'air intérieure et extérieure et d'un thermostat pour commandé le chauffage. 

          Pilotable en mode automatique sur la base de paramètres de configuration ou manuellement au travers 
          d'une interface web PWA.

          </p>
          
          </br>
            <img src="static/img/favicon-96x96.png" class="class="rounded float-center img-responsive" alt="Responsive image">
          </br>
                  
          <div class="modal-footer">
            </br>
            {{APPAUTHOR}} {{APPDATE}}
            </br>
          </div>

          <div class="buttons">
              <a href="/actionneurs" class="btn btn-primary btn-block accept-cookies" data-bs-dismiss="offcanvas">
                  Quitter</a>
          </div>
      </div>
    </div>
    <!-- * A propos de Cookies Box -->



  <!-- Modal (confirm reboot) -->

  <div class="modal fade dialogbox" id="confirm_reboot" data-bs-backdrop="static" tabindex="-1" role="dialog" >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Redémarrer (reboot)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Êtes-vous sûr ? </p>
        </div>
        <div class="modal-footer">
          <form method="POST" role="form" action="/reboot" class="center-block">
            <button type="submit" class="btn btn-danger"  name="shutdown" value="refresh">Confirmer</button> 
          </form> 
        </div>
      </div>
    </div>
  </div>

  <!-- * Modal (reboot) -->

  <!-- Modal (confirm shutdown) --->

  <div class="modal fade dialogbox" id="confirm_shutdown" data-bs-backdrop="static" tabindex="-1" role="dialog" >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Eteindre (shutdown)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Êtes-vous sûr ? </p>
        </div>
        <div class="modal-footer">
          <form method="POST" role="form" action="/shutdown" class="center-block">
            <button type="submit" class="btn btn-danger"  name="shutdown" value="refresh">Confirmer</button> 
          </form> 
        </div>
      </div>
    </div>
  </div>


  <!-- * Modal (shutdown) -->



  <script>

    // fonction appelée lors d'un refraichissement des paramètres de configuration

    function getParameters() {
        $.ajax({
          url: "/getparameters",
          type: "get",
          dataType: 'json',
          contentType: 'application/json',
          data: {},
          success: function(response) {
            var obj = JSON.parse(JSON.stringify(response));
            document.getElementById('TMAX').value = obj.TMAX;
            document.getElementById('TMIN').value = obj.TMIN;
            document.getElementById('INTERVAL_DISPLAY').value = obj.INTERVAL_DISPLAY;
            document.getElementById('INTERVAL_LOOP').value = obj.INTERVAL_LOOP;
            document.getElementById('SCHEDULER_START').value = obj.SCHEDULER_START;
            document.getElementById('SCHEDULER_STOP').value = obj.SCHEDULER_STOP;
            document.getElementById('PLUG').value = obj.PLUG;
            document.getElementById('HEATER').value = obj.HEATER;
            document.getElementById('SCHEDULER').value = obj.SCHEDULER;
            document.getElementById('DEBUG').value = obj.DEBUG;
            document.getElementById('TIME').value = obj.TIME;
            document.getElementById('DATE').value = obj.DATE;
            }
          });
      }
  </script>


    
  <script>

      // fonction appelée lors d'un changement d'état du switch pour thermostat auto mode

    function thermostat_auto_mode(state) {
      $.ajax({
        url: "/thermostat/auto",
        type: "post",
        data: {state:state},
        success: function(response) {
        }
      });
    }
  </script>

  <script>

        // fonction appelée lors d'un changement d'état du switch pour lumière

      function light(state) {
        $.ajax({
          url: "/light",
          type: "post",
          data: {state:state},
          success: function(response) {
          }
        });
      
      }
  </script>

  <script>

    // fonction appelée lors d'un changement d'état du switch pour le chauffage

  function heater(state) {
    $.ajax({
      url: "/heater",
      type: "post",
      data: {state:state},
      success: function(response) {
      }
    });
  
  }
  </script>

  <script>

    // fonction appelée lors d'un changement d'état du switch pour le planificateur

  function scheduler(state) {
    $.ajax({
      url: "/scheduler",
      type: "post",
      data: {state:state},
      success: function(response) {
      }
    });

  }
  </script>


  <script>

    // fonction appelée lors d'un changement d'état du switch pour le planificateur

  function debug_mode(state) {
    $.ajax({
      url: "/debug_mode",
      type: "post",
      data: {state:state},
      success: function(response) {
      }
    });

  }
  </script>

  <script>

    // fonction appelée lors d'un changement d'état du switch pour le planificateur

  function plug(state) {
    $.ajax({
      url: "/plug",
      type: "post",
      data: {state:state},
      success: function(response) {
      }
    });

  }
  </script>

  <script>
      // Add to Home with 2 seconds delay.
      AddtoHome("2000", "once");
  </script>

</body>
</html>