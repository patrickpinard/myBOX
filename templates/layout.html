<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover"
/>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta
  name="apple-mobile-web-app-status-bar-style"
  content="black-translucent"
/>
<meta name="theme-color" content="#000000" />
<title>BOX Atelier</title>

<link
  rel="icon"
  type="image/png"
  href="static/img/favicon-32x32.png"
  sizes="32x32"
/>
<link
  rel="apple-touch-icon"
  sizes="196x196"
  href="static/img/favicon-196x196.png"
/>
<link rel="stylesheet" href="static/css/style.css" />
<link rel="manifest" href="__manifest.json" />

<!-- ========= JS Files =========  -->

<!-- Bootstrap local
  <script src="static/js/lib/bootstrap.bundle.min.js"></script>-->
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
  crossorigin="anonymous"
></script>

<!-- Ionicons -->
<script
  type="module"
  src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
></script>

<!-- Base Js File -->
<script src="static/js/base.js"></script>

<!-- Apex Charts 
  <script src="static/js/plugins/apexcharts/apexcharts.min.js"></script>-->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<!-- jquery 
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<!-- App Header -->
<div class="appHeader bg-primary text-light">
  <div class="left">
    <a
      href="#"
      class="headerButton"
      data-bs-toggle="modal"
      data-bs-target="#sidebarPanel"
    >
      <ion-icon name="menu-outline"></ion-icon>
    </a>
  </div>

  <div class="pageTitle">
    <img
      src="static/img/favicon-32x32.png"
      style="color: white"
      type="image/png"
      sizes="32x32"
    />
    <strong> MyBOX </strong>
  </div>

  <div class="right">
    <a
      class="headerButton"
      href="#infobox"
      class="item"
      data-bs-toggle="modal"
      data-bs-target="#infobox"
    >
      <ion-icon
        style="color: rgb(252, 249, 249)"
        name="information-circle"
      ></ion-icon>
    </a>
  </div>
</div>

{% block body %}{% endblock %}

<!-- App Bottom Menu -->
<div class="appBottomMenu">
  <a href="/actionneurs" class="item">
    <div class="col">
      <ion-icon name="toggle-outline"></ion-icon>
      <strong>Actionneurs</strong>
    </div>
  </a>

  <a href="/capteurs" class="item">
    <div class="col">
      <ion-icon name="speedometer-outline">"&gt;</ion-icon>
      <strong>Capteurs</strong>
    </div>
  </a>

  <a href="/graph" class="item">
    <div class="col">
      <ion-icon name="pie-chart-outline"></ion-icon>
      <strong>Graphiques</strong>
    </div>
  </a>

  <a href="/parameters" class="item">
    <div class="col">
      <ion-icon name="construct-outline"></ion-icon>
      <strong>Paramètres</strong>
    </div>
  </a>

  <a href="/eventslog" class="item">
    <div class="col">
      <ion-icon name="list-outline"></ion-icon>
      <strong>Evénements</strong>
    </div>
  </a>

  <a href="/camera" class="item">
    <div class="col">
      <ion-icon name="videocam-outline"></ion-icon>
      <strong>Camera</strong>
    </div>
  </a>
</div>
<!-- * App Bottom Menu -->

<!-- App Sidebar -->
<div
  class="modal fade panelbox panelbox-left"
  id="sidebarPanel"
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body p-0">
        <!-- profile box -->
        <div class="profileBox pt-2 pb-2">
          <div class="image-wrapper">
            <img src="static/img/profile.png" alt="image" class="imaged w36" />
          </div>
          <div class="in">
            <strong> Bienvenue : {{USERNAME}} </strong>
            upsince : {{LASTREBOOT}}
          </div>
          <a
            href="#"
            class="btn btn-link btn-icon sidebar-close"
            data-bs-dismiss="modal"
          >
            <ion-icon name="close-outline"></ion-icon>
          </a>
        </div>
        <!-- * profile box -->

        <!-- menu -->
        <div class="listview-title mt-1"></div>

        <ul class="listview flush transparent no-line image-listview">
          <li>
            <a
              href="#infobox"
              class="item"
              data-bs-toggle="modal"
              data-bs-target="#infobox"
            >
              <div class="icon-box bg-success">
                <ion-icon name="help-circle-outline"></ion-icon>
              </div>
              <div class="in">A propos de MyBox</div>
            </a>
          </li>

          <div class="dropdown-divider"></div>

          <li>
            <a href="/actionneurs" class="item">
              <div class="icon-box bg-primary">
                <ion-icon name="toggle-outline"></ion-icon>
              </div>
              <div class="in">
                <strong>Actionneurs</strong>
              </div>
            </a>
          </li>

          <li>
            <a href="/capteurs" class="item">
              <div class="icon-box bg-primary">
                <ion-icon name="speedometer-outline"></ion-icon>
              </div>
              <div class="in">
                <strong>Capteurs</strong>
              </div>
            </a>
          </li>

          <li>
            <a href="/graph" class="item">
              <div class="icon-box bg-primary">
                <ion-icon name="pie-chart-outline"></ion-icon>
              </div>
              <div class="in">
                <strong>Graphiques</strong>
              </div>
            </a>
          </li>
          <li>
            <a href="/parameters" class="item">
              <div class="icon-box bg-primary">
                <ion-icon name="construct-outline"></ion-icon>
              </div>
              <div class="in">
                <strong>Paramètres</strong>
              </div>
            </a>
          </li>

          <li>
            <a href="/eventslog" class="item">
              <div class="icon-box bg-primary">
                <ion-icon name="list-outline"></ion-icon>
              </div>
              <div class="in">
                <strong>Evénements</strong>
              </div>
            </a>
          </li>

          <li>
            <a href="/camera" class="item">
              <div class="icon-box bg-primary">
                <ion-icon name="videocam-outline"></ion-icon>
              </div>
              <div class="in">
                <strong>Camera</strong>
              </div>
            </a>
          </li>

          <div class="dropdown-divider"></div>

          <li>
            <a
              href="#confirm_reboot"
              class="item"
              data-bs-toggle="modal"
              data-bs-target="#confirm_reboot"
            >
              <div class="icon-box bg-danger">
                <ion-icon name="refresh"></ion-icon>
              </div>
              <div class="in">Reboot</div>
            </a>
          </li>

          <li>
            <a
              href="#confirm_shutdown"
              class="item"
              data-bs-toggle="modal"
              data-bs-target="#confirm_shutdown"
            >
              <div class="icon-box bg-danger">
                <ion-icon name="power"></ion-icon>
              </div>
              <div class="in">Eteindre</div>
            </a>
          </li>
        </ul>
        <!-- * menu -->
      </div>
    </div>
  </div>
</div>
<!-- * App Sidebar -->

<!-- Notification (placer en haut droite)-->

<div
  id="notificationbox"
  class="offcanvas offcanvas-bottom cookies-box"
  tabindex="-1"
  data-bs-scroll="true"
  data-bs-backdrop="false"
  style="max-width: 300px"
>
  <div class="offcanvas-header">
    <h3 class="modal-title">Notifications</h3>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    ></button>
  </div>

  <div class="offcanvas-body">
    <div class="section mt-1 mb-2">
      <div class="card">
        <div class="card-body">
          <div class="alert alert-primary mb-2" role="alert">
            A simple alert!
          </div>

          <div
            class="alert alert-primary alert-dismissible fade show mb-2"
            role="alert"
          >
            Dismissible alert!
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>

          <div
            class="alert alert-outline-primary alert-dismissible fade show"
            role="alert"
          >
            Outline alert!
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Info Box -->

<div
  class="modal fade dialogbox"
  id="infobox"
  data-bs-backdrop="static"
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">A propos de MyBox {{APPVERSION}}</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <p>
          Boitier connecté et commandé via une APP web. Equipé d'un Raspberry Pi
          4 qui pilote trois relais 240V, d'une sonde d'humidité (extérieure) et
          de deux sondes de températures de l'air (intérieure et extérieure) et
          d'un thermostat pour commandé le chauffage. Une caméra USB pour la
          vidép surveillance. Le tout, pilotable en mode automatique sur la base
          de paramètres de configuration ou manuellement.
        </p>
        <br />
        <img
          src="static/img/favicon-96x96.png"
          class="rounded float-center img-responsive"
          alt=" Responsive image"
        />
        <br />
        <br />
        {{APPAUTHOR}} {{APPDATE}}
      </div>
    </div>
  </div>
</div>

<!-- * Modal (reboot) -->

<div
  id="cookiesboxOLD"
  class="offcanvas offcanvas-top cookies-box"
  tabindex="-1"
  data-bs-scroll="true"
  data-bs-backdrop="false"
  style="max-width: 500px"
>
  <div class="offcanvas-header">
    <h3 class="modal-title">{{APPNAME}} {{APPVERSION}}</h3>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    ></button>
  </div>

  <div class="offcanvas-body">
    <p>MyBOX est un projet de boitier connecté et commandé via une APP web.</p>
    <p>
      Equipé d'un Raspberry Pi 4 qui pilote trois relais 240V, d'une sonde
      d'humidité de l'air, de sondes de températures de l'air intérieure et
      extérieure et d'un thermostat pour commandé le chauffage.
    </p>
    <p>
      Pilotable en mode automatique sur la base de paramètres de configuration
      ou manuellement au travers d'une interface web PWA.
    </p>
    <br />
    <img
      src="static/img/favicon-96x96.png"
      class="rounded float-center img-responsive"
      alt=" Responsive image"
    />
    <br />
    <br />
    <!--- <div class="modal-footer"> --->
    {{APPAUTHOR}} {{APPDATE}}
    <!---</div> -->
  </div>
</div>

<!-- * A propos de Cookies Box -->

<!-- Modal (confirm reboot) -->

<div
  class="modal fade dialogbox"
  id="confirm_reboot"
  data-bs-backdrop="static"
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Redémarrer (reboot)</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <p>Attention ! Êtes-vous sûr ?</p>
      </div>
      <div class="modal-footer">
        <form method="POST" role="form" action="/reboot" class="center-block">
          <button
            type="submit"
            class="btn btn-danger"
            name="shutdown"
            value="refresh"
          >
            Confirmer
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- * Modal (reboot) -->

<!-- Modal (confirm shutdown) --->

<div
  class="modal fade dialogbox"
  id="confirm_shutdown"
  data-bs-backdrop="static"
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Eteindre (shutdown)</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <p>Attention ! Êtes-vous sûr ?</p>
      </div>
      <div class="modal-footer">
        <form method="POST" role="form" action="/shutdown" class="center-block">
          <button
            type="submit"
            class="btn btn-danger"
            name="shutdown"
            value="refresh"
          >
            Confirmer
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- * Modal (shutdown) -->

<script>
  // fonction appelée lors d'un refraichissement des paramètres de configuration

  function getParameters() {
    $.ajax({
      url: "/getparameters",
      type: "get",
      dataType: "json",
      contentType: "application/json",
      data: {},
      success: function (response) {
        var obj = JSON.parse(JSON.stringify(response));
        document.getElementById("TMAX").value = obj.TMAX;
        document.getElementById("TMIN").value = obj.TMIN;
        document.getElementById("INTERVAL_DISPLAY").value =
          obj.INTERVAL_DISPLAY;
        document.getElementById("INTERVAL_LOOP").value = obj.INTERVAL_LOOP;
        document.getElementById("SCHEDULER_START").value = obj.SCHEDULER_START;
        document.getElementById("SCHEDULER_STOP").value = obj.SCHEDULER_STOP;
        document.getElementById("DEBUG").value = obj.DEBUG;
        document.getElementById("CAMERA").value = obj.CAMERA;
      },
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour thermostat auto mode

  function thermostat_auto_mode(state) {
    $.ajax({
      url: "/thermostat/auto",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour lumière

  function light(state) {
    $.ajax({
      url: "/light",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour le chauffage

  function heater(state) {
    $.ajax({
      url: "/heater",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour le planificateur

  function scheduler(state) {
    $.ajax({
      url: "/scheduler",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour le planificateur

  function debug_mode(state) {
    $.ajax({
      url: "/debug_mode",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour le planificateur

  function plug(state) {
    $.ajax({
      url: "/plug",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour la camera

  function camera(state) {
    $.ajax({
      url: "/setcamera",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  // fonction appelée lors d'un changement d'état du switch pour ventilation du CPU

  function fan(state) {
    $.ajax({
      url: "/fan",
      type: "post",
      data: { state: state },
      success: function (response) {},
    });
  }
</script>

<script>
  function resolution() {
    var selectedValue = document.getElementById("resolution").value;
    // Add logic to filter data based on selectedValue
    console.log(selectedValue);
  }
</script>

<script>
  function updateCompressionValue() {
    var compressionInput = document.getElementById("compression");
    var compressionValueDisplay = document.getElementById("compressionValue");
    compressionValueDisplay.innerHTML = compressionInput.value;
  }
</script>
